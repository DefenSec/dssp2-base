;; -*- mode: CIL; fill-column: 79; indent-tabs-mode: nil; -*-
;; SPDX-License-Identifier: Unlicense

;; fs
;;     obj_all_macro_template
;;     obj_stub
;;     obj_template
;;     aio
;;     anon_inodefs
;;     autofs
;;     bdev
;;     binfmt_misc
;;     cgroup
;;     cifs
;;     configfs
;;     debugfs
;;     devpts
;;     devtmpfs
;;     dosfs
;;     drm
;;     efivarfs
;;     fuse
;;     hugetlbfs
;;     iso9660
;;     nfs
;;     nfsd
;;     nsfs
;;     proc
;;     pstore
;;     removable
;;     rootfs
;;     rpc_pipefs
;;     sysfs
;;     tmpfs
;;     tracefs
;;     xattr

;;
;; Policy
;;

(sid fs)

(block fs

       ;;
       ;; Macros
       ;;

       (macro dontaudit_mount ((type ARG1))
              (dontaudit ARG1 obj_type_attribute (filesystem (mount))))

       (macro dontaudit_remount ((type ARG1))
              (dontaudit ARG1 obj_type_attribute (filesystem (remount))))

       (macro dontaudit_unmount ((type ARG1))
              (dontaudit ARG1 obj_type_attribute (filesystem (unmount))))

       (blockinherit obj_all_macro_template)

       (macro unconfined_subj_type ((type ARG1))
              (typeattributeset unconfined_subj_type_attribute ARG1))

       ;;
       ;; Policy
       ;;

       (typeattribute obj_type_attribute)
       (typeattribute unconfined_subj_type_attribute)

       (allow obj_type_attribute self (filesystem (associate)))

       (allow unconfined_subj_type_attribute obj_type_attribute
              blk_file_except_execmod_map_and_mounton)
       (allow unconfined_subj_type_attribute obj_type_attribute
              chr_file_except_execmod_and_mounton)
       (allow unconfined_subj_type_attribute obj_type_attribute
              dir_except_execmod_and_map)
       (allow unconfined_subj_type_attribute obj_type_attribute
              fifo_file_except_execmod_map_and_mounton)
       (allow unconfined_subj_type_attribute obj_type_attribute
              file_except_entrypoint_execmod_and_mounton)

       (allow unconfined_subj_type_attribute obj_type_attribute (filesystem
                                                                 (all)))

       (allow unconfined_subj_type_attribute obj_type_attribute
              lnk_file_except_execmod_map_and_mounton)
       (allow unconfined_subj_type_attribute obj_type_attribute
              sock_file_except_execmod_map_and_mounton)

       (call sys.obj_type (obj_type_attribute))

       ;;
       ;; Templates
       ;;

       (block obj_all_macro_template

              ;;
              ;; Macros
              ;;

              (macro dontaudit_getattr_fs ((type ARG1))
                     (dontaudit ARG1 obj_type_attribute (filesystem
                                                         (getattr))))

              (macro add_entries ((type ARG1))
                     (allow ARG1 obj_type_attribute add_entry_dir_perms))

              (macro append_files ((type ARG1))
                     (allow ARG1 obj_type_attribute append_file_perms)
                     (call search (ARG1)))

              (macro associate ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (associate))))

              (macro create ((type ARG1))
                     (call create_dirs (ARG1))
                     (call create_files (ARG1))
                     (call create_lnk_files (ARG1)))

              (macro create_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (create))))

              (macro create_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (create))))

              (macro create_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (create))))

              (macro del_entries ((type ARG1))
                     (allow ARG1 obj_type_attribute del_entry_dir_perms))

              (macro delete ((type ARG1))
                     (call delete_dirs (ARG1))
                     (call delete_files (ARG1))
                     (call delete_lnk_files (ARG1)))

              (macro delete_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (delete))))

              (macro delete_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (delete))))

              (macro delete_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (delete))))

              (macro execute ((type ARG1))
                     (allow ARG1 obj_type_attribute exec_file_perms)
                     (call search (ARG1)))

              (macro getattr ((type ARG1))
                     (call getattr_dirs (ARG1))
                     (call getattr_files (ARG1))
                     (call getattr_lnk_files (ARG1)))

              (macro getattr_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (getattr))))

              (macro getattr_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (getattr))))

              (macro getattr_fs ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (getattr))))

              (macro getattr_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (getattr))))

              (macro list ((type ARG1))
                     (allow ARG1 obj_type_attribute list_dir_perms))

              (macro manage ((type ARG1))
                     (call manage_dirs (ARG1))
                     (call manage_files (ARG1))
                     (call manage_lnk_files (ARG1)))

              (macro manage_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (manage))))

              (macro manage_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (manage))))

              (macro manage_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (manage))))

              (macro map_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (map))))

              (macro mapr_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (mapr))))

              (macro maprw_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (maprw))))

              (macro maprx ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (maprx))))

              (macro mount ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (mount))))

              (macro obj_type ((type ARG1))
                     (typeattributeset obj_type_attribute ARG1))

              (macro quotaget ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (quotaget))))

              (macro quotamod ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (quotamod))))

              (macro read ((type ARG1))
                     (call list (ARG1))
                     (call read_files (ARG1))
                     (call read_lnk_files (ARG1)))

              (macro read_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (read))))

              (macro read_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (read))))

              (macro relabel ((type ARG1))
                     (call relabel_dirs (ARG1))
                     (call relabel_files (ARG1))
                     (call relabel_lnk_files (ARG1)))

              (macro relabel_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (relabel))))

              (macro relabel_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (relabel))))

              (macro relabel_fs ((type ARG1))
                     (allow ARG1 obj_type_attribute
                            (filesystem (getattr relabelfrom relabelto))))

              (macro relabel_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (relabel))))

              (macro relabelfrom ((type ARG1))
                     (call relabelfrom_dirs (ARG1))
                     (call relabelfrom_files (ARG1))
                     (call relabelfrom_lnk_files (ARG1)))

              (macro relabelfrom_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (relabelfrom))))

              (macro relabelfrom_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (relabelfrom))))

              (macro relabelfrom_fs ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem
                                                     (getattr relabelfrom))))

              (macro relabelfrom_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (relabelfrom))))

              (macro relabelto ((type ARG1))
                     (call relabelto_dirs (ARG1))
                     (call relabelto_files (ARG1))
                     (call relabelto_lnk_files (ARG1)))

              (macro relabelto_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (relabelto))))

              (macro relabelto_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (relabelto))))

              (macro relabelto_fs ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem
                                                     (getattr relabelto))))

              (macro relabelto_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (relabelto))))

              (macro remount ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (remount))))

              (macro rename ((type ARG1))
                     (call rename_dirs (ARG1))
                     (call rename_files (ARG1))
                     (call rename_lnk_files (ARG1)))

              (macro rename_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (rename))))

              (macro rename_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (rename))))

              (macro rename_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (rename))))

              (macro rw ((type ARG1))
                     (call rw_dirs (ARG1))
                     (call rw_files (ARG1))
                     (call rw_lnk_files (ARG1)))

              (macro rw_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (rw))))

              (macro rw_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (rw))))

              (macro rw_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (rw))))

              (macro search ((type ARG1))
                     (allow ARG1 obj_type_attribute search_dir_perms))

              (macro setattr ((type ARG1))
                     (call setattr_dirs (ARG1))
                     (call setattr_files (ARG1))
                     (call setattr_lnk_files (ARG1)))

              (macro setattr_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (setattr))))

              (macro setattr_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (setattr))))

              (macro setattr_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_file (setattr))))

              (macro write ((type ARG1))
                     (call write_dirs (ARG1))
                     (call write_files (ARG1))
                     (call write_lnk_files (ARG1)))

              (macro write_dirs ((type ARG1))
                     (allow ARG1 obj_type_attribute (dirs (write))))

              (macro write_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (files (write))))

              (macro write_lnk_files ((type ARG1))
                     (allow ARG1 obj_type_attribute (lnk_files (write))))

              (macro unmount ((type ARG1))
                     (allow ARG1 obj_type_attribute (filesystem (unmount))))

              ;;
              ;; Policy
              ;;

              (blockabstract obj_all_macro_template))

       (block obj_stub

              ;;
              ;; Contexts
              ;;

              (context fs_context (sys.id sys.role fs (systemlow systemlow)))

              ;;
              ;; Policy
              ;;

              (blockabstract obj_stub)

              (type fs)
              (call fs.obj_type (fs)))

       (block obj_template

              ;;
              ;; Macros
              ;;

              (macro associate ((type ARG1))
                     (allow ARG1 fs (filesystem (associate))))

              (macro getattr_fs ((type ARG1))
                     (allow ARG1 fs (filesystem (getattr))))

              (macro mount ((type ARG1))
                     (allow ARG1 fs (filesystem (mount))))

              (macro quotaget ((type ARG1))
                     (allow ARG1 fs (filesystem (quotaget))))

              (macro quotamod ((type ARG1))
                     (allow ARG1 fs (filesystem (quotamod))))

              (macro relabel_fs ((type ARG1))
                     (allow ARG1 fs (filesystem (getattr relabelfrom
                                                         relabelto))))

              (macro relabelfrom_fs ((type ARG1))
                     (allow ARG1 fs (filesystem (getattr relabelfrom))))

              (macro relabelto_fs ((type ARG1))
                     (allow ARG1 fs (filesystem (getattr relabelto))))

              (macro remount ((type ARG1))
                     (allow ARG1 fs (filesystem (remount))))

              (macro unmount ((type ARG1))
                     (allow ARG1 fs (filesystem (unmount))))

              ;;
              ;; Policy
              ;;

              (blockabstract obj_template)

              (blockinherit fs.obj_stub))

       (block aio

              ;;
              ;; Contexts
              ;;

              (genfscon "aio" "/" fs_context)

              ;;
              ;; Macros
              ;;

              (macro add_entries ((type ARG1))
                     (allow ARG1 fs add_entry_dir_perms))

              (macro append_files ((type ARG1))
                     (allow ARG1 fs append_file_perms)
                     (call search (ARG1)))

              (macro create ((type ARG1))
                     (call create_dirs (ARG1))
                     (call create_files (ARG1))
                     (call create_lnk_files (ARG1)))

              (macro create_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (create))))

              (macro create_files ((type ARG1))
                     (allow ARG1 fs (files (create))))

              (macro create_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (create))))

              (macro del_entries ((type ARG1))
                     (allow ARG1 fs del_entry_dir_perms))

              (macro delete ((type ARG1))
                     (call delete_dirs (ARG1))
                     (call delete_files (ARG1))
                     (call delete_lnk_files (ARG1)))

              (macro delete_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (delete))))

              (macro delete_files ((type ARG1))
                     (allow ARG1 fs (files (delete))))

              (macro delete_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (delete))))

              (macro execute ((type ARG1))
                     (allow ARG1 fs exec_file_perms)
                     (call search (ARG1)))

              (macro getattr ((type ARG1))
                     (call getattr_dirs (ARG1))
                     (call getattr_files (ARG1))
                     (call getattr_lnk_files (ARG1)))

              (macro getattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (getattr))))

              (macro getattr_files ((type ARG1))
                     (allow ARG1 fs (files (getattr))))

              (macro getattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (getattr))))

              (macro list ((type ARG1))
                     (allow ARG1 fs list_dir_perms))

              (macro manage ((type ARG1))
                     (call manage_dirs (ARG1))
                     (call manage_files (ARG1))
                     (call manage_lnk_files (ARG1)))

              (macro manage_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (manage))))

              (macro manage_files ((type ARG1))
                     (allow ARG1 fs (files (manage))))

              (macro manage_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (manage))))

              (macro map_files ((type ARG1))
                     (allow ARG1 fs (files (map))))

              (macro mapr_files ((type ARG1))
                     (allow ARG1 fs (files (mapr))))

              (macro maprw_files ((type ARG1))
                     (allow ARG1 fs (files (maprw))))

              (macro maprx ((type ARG1))
                     (allow ARG1 fs (files (maprx))))

              (macro read ((type ARG1))
                     (call list (ARG1))
                     (call read_files (ARG1))
                     (call read_lnk_files (ARG1)))

              (macro read_files ((type ARG1))
                     (allow ARG1 fs (files (read))))

              (macro read_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (read))))

              (macro relabel ((type ARG1))
                     (call relabel_dirs (ARG1))
                     (call relabel_files (ARG1))
                     (call relabel_lnk_files (ARG1)))

              (macro relabel_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabel))))

              (macro relabel_files ((type ARG1))
                     (allow ARG1 fs (files (relabel))))

              (macro relabel_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabel))))

              (macro relabelfrom ((type ARG1))
                     (call relabelfrom_dirs (ARG1))
                     (call relabelfrom_files (ARG1))
                     (call relabelfrom_lnk_files (ARG1)))

              (macro relabelfrom_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelfrom))))

              (macro relabelfrom_files ((type ARG1))
                     (allow ARG1 fs (files (relabelfrom))))

              (macro relabelfrom_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelfrom))))

              (macro relabelto ((type ARG1))
                     (call relabelto_dirs (ARG1))
                     (call relabelto_files (ARG1))
                     (call relabelto_lnk_files (ARG1)))

              (macro relabelto_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelto))))

              (macro relabelto_files ((type ARG1))
                     (allow ARG1 fs (files (relabelto))))

              (macro relabelto_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelto))))

              (macro rename ((type ARG1))
                     (call rename_dirs (ARG1))
                     (call rename_files (ARG1))
                     (call rename_lnk_files (ARG1)))

              (macro rename_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rename))))

              (macro rename_files ((type ARG1))
                     (allow ARG1 fs (files (rename))))

              (macro rename_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rename))))

              (macro rw ((type ARG1))
                     (call rw_dirs (ARG1))
                     (call rw_files (ARG1))
                     (call rw_lnk_files (ARG1)))

              (macro rw_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rw))))

              (macro rw_files ((type ARG1))
                     (allow ARG1 fs (files (rw))))

              (macro rw_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rw))))

              (macro search ((type ARG1))
                     (allow ARG1 fs search_dir_perms))

              (macro setattr ((type ARG1))
                     (call setattr_dirs (ARG1))
                     (call setattr_files (ARG1))
                     (call setattr_lnk_files (ARG1)))

              (macro setattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (setattr))))

              (macro setattr_files ((type ARG1))
                     (allow ARG1 fs (files (setattr))))

              (macro setattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (setattr))))

              (macro write ((type ARG1))
                     (call write_dirs (ARG1))
                     (call write_files (ARG1))
                     (call write_lnk_files (ARG1)))

              (macro write_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (write))))

              (macro write_files ((type ARG1))
                     (allow ARG1 fs (files (write))))

              (macro write_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (write))))

              ;;
              ;; Policy
              ;;

              (blockinherit fs.obj_template))

       (block anon_inodefs

              ;;
              ;; Contexts
              ;;

              (genfscon "anon_inodefs" "/" fs_context)

              ;;
              ;; Macros
              ;;

              (macro add_entries ((type ARG1))
                     (allow ARG1 fs add_entry_dir_perms))

              (macro append_files ((type ARG1))
                     (allow ARG1 fs append_file_perms)
                     (call search (ARG1)))

              (macro create ((type ARG1))
                     (call create_dirs (ARG1))
                     (call create_files (ARG1))
                     (call create_lnk_files (ARG1)))

              (macro create_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (create))))

              (macro create_files ((type ARG1))
                     (allow ARG1 fs (files (create))))

              (macro create_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (create))))

              (macro del_entries ((type ARG1))
                     (allow ARG1 fs del_entry_dir_perms))

              (macro delete ((type ARG1))
                     (call delete_dirs (ARG1))
                     (call delete_files (ARG1))
                     (call delete_lnk_files (ARG1)))

              (macro delete_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (delete))))

              (macro delete_files ((type ARG1))
                     (allow ARG1 fs (files (delete))))

              (macro delete_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (delete))))

              (macro execute ((type ARG1))
                     (allow ARG1 fs exec_file_perms)
                     (call search (ARG1)))

              (macro getattr ((type ARG1))
                     (call getattr_dirs (ARG1))
                     (call getattr_files (ARG1))
                     (call getattr_lnk_files (ARG1)))

              (macro getattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (getattr))))

              (macro getattr_files ((type ARG1))
                     (allow ARG1 fs (files (getattr))))

              (macro getattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (getattr))))

              (macro list ((type ARG1))
                     (allow ARG1 fs list_dir_perms))

              (macro manage ((type ARG1))
                     (call manage_dirs (ARG1))
                     (call manage_files (ARG1))
                     (call manage_lnk_files (ARG1)))

              (macro manage_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (manage))))

              (macro manage_files ((type ARG1))
                     (allow ARG1 fs (files (manage))))

              (macro manage_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (manage))))

              (macro map_files ((type ARG1))
                     (allow ARG1 fs (files (map))))

              (macro mapr_files ((type ARG1))
                     (allow ARG1 fs (files (mapr))))

              (macro maprw_files ((type ARG1))
                     (allow ARG1 fs (files (maprw))))

              (macro maprx ((type ARG1))
                     (allow ARG1 fs (files (maprx))))

              (macro read ((type ARG1))
                     (call list (ARG1))
                     (call read_files (ARG1))
                     (call read_lnk_files (ARG1)))

              (macro read_files ((type ARG1))
                     (allow ARG1 fs (files (read))))

              (macro read_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (read))))

              (macro relabel ((type ARG1))
                     (call relabel_dirs (ARG1))
                     (call relabel_files (ARG1))
                     (call relabel_lnk_files (ARG1)))

              (macro relabel_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabel))))

              (macro relabel_files ((type ARG1))
                     (allow ARG1 fs (files (relabel))))

              (macro relabel_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabel))))

              (macro relabelfrom ((type ARG1))
                     (call relabelfrom_dirs (ARG1))
                     (call relabelfrom_files (ARG1))
                     (call relabelfrom_lnk_files (ARG1)))

              (macro relabelfrom_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelfrom))))

              (macro relabelfrom_files ((type ARG1))
                     (allow ARG1 fs (files (relabelfrom))))

              (macro relabelfrom_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelfrom))))

              (macro relabelto ((type ARG1))
                     (call relabelto_dirs (ARG1))
                     (call relabelto_files (ARG1))
                     (call relabelto_lnk_files (ARG1)))

              (macro relabelto_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelto))))

              (macro relabelto_files ((type ARG1))
                     (allow ARG1 fs (files (relabelto))))

              (macro relabelto_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelto))))

              (macro rename ((type ARG1))
                     (call rename_dirs (ARG1))
                     (call rename_files (ARG1))
                     (call rename_lnk_files (ARG1)))

              (macro rename_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rename))))

              (macro rename_files ((type ARG1))
                     (allow ARG1 fs (files (rename))))

              (macro rename_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rename))))

              (macro rw ((type ARG1))
                     (call rw_dirs (ARG1))
                     (call rw_files (ARG1))
                     (call rw_lnk_files (ARG1)))

              (macro rw_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rw))))

              (macro rw_files ((type ARG1))
                     (allow ARG1 fs (files (rw))))

              (macro rw_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rw))))

              (macro search ((type ARG1))
                     (allow ARG1 fs search_dir_perms))

              (macro setattr ((type ARG1))
                     (call setattr_dirs (ARG1))
                     (call setattr_files (ARG1))
                     (call setattr_lnk_files (ARG1)))

              (macro setattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (setattr))))

              (macro setattr_files ((type ARG1))
                     (allow ARG1 fs (files (setattr))))

              (macro setattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (setattr))))

              (macro write ((type ARG1))
                     (call write_dirs (ARG1))
                     (call write_files (ARG1))
                     (call write_lnk_files (ARG1)))

              (macro write_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (write))))

              (macro write_files ((type ARG1))
                     (allow ARG1 fs (files (write))))

              (macro write_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (write))))

              ;;
              ;; Policy
              ;;

              (blockinherit fs.obj_template))

       (block autofs

              ;;
              ;; Contexts
              ;;

              (genfscon "autofs" "/" fs_context)

              ;;
              ;; Macros
              ;;

              (macro add_entries ((type ARG1))
                     (allow ARG1 fs add_entry_dir_perms))

              (macro append_files ((type ARG1))
                     (allow ARG1 fs append_file_perms)
                     (call search (ARG1)))

              (macro create ((type ARG1))
                     (call create_dirs (ARG1))
                     (call create_files (ARG1))
                     (call create_lnk_files (ARG1)))

              (macro create_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (create))))

              (macro create_files ((type ARG1))
                     (allow ARG1 fs (files (create))))

              (macro create_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (create))))

              (macro del_entries ((type ARG1))
                     (allow ARG1 fs del_entry_dir_perms))

              (macro delete ((type ARG1))
                     (call delete_dirs (ARG1))
                     (call delete_files (ARG1))
                     (call delete_lnk_files (ARG1)))

              (macro delete_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (delete))))

              (macro delete_files ((type ARG1))
                     (allow ARG1 fs (files (delete))))

              (macro delete_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (delete))))

              (macro execute ((type ARG1))
                     (allow ARG1 fs exec_file_perms)
                     (call search (ARG1)))

              (macro getattr ((type ARG1))
                     (call getattr_dirs (ARG1))
                     (call getattr_files (ARG1))
                     (call getattr_lnk_files (ARG1)))

              (macro getattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (getattr))))

              (macro getattr_files ((type ARG1))
                     (allow ARG1 fs (files (getattr))))

              (macro getattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (getattr))))

              (macro list ((type ARG1))
                     (allow ARG1 fs list_dir_perms))

              (macro manage ((type ARG1))
                     (call manage_dirs (ARG1))
                     (call manage_files (ARG1))
                     (call manage_lnk_files (ARG1)))

              (macro manage_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (manage))))

              (macro manage_files ((type ARG1))
                     (allow ARG1 fs (files (manage))))

              (macro manage_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (manage))))

              (macro map_files ((type ARG1))
                     (allow ARG1 fs (files (map))))

              (macro mapr_files ((type ARG1))
                     (allow ARG1 fs (files (mapr))))

              (macro maprw_files ((type ARG1))
                     (allow ARG1 fs (files (maprw))))

              (macro maprx ((type ARG1))
                     (allow ARG1 fs (files (maprx))))

              (macro read ((type ARG1))
                     (call list (ARG1))
                     (call read_files (ARG1))
                     (call read_lnk_files (ARG1)))

              (macro read_files ((type ARG1))
                     (allow ARG1 fs (files (read))))

              (macro read_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (read))))

              (macro relabel ((type ARG1))
                     (call relabel_dirs (ARG1))
                     (call relabel_files (ARG1))
                     (call relabel_lnk_files (ARG1)))

              (macro relabel_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabel))))

              (macro relabel_files ((type ARG1))
                     (allow ARG1 fs (files (relabel))))

              (macro relabel_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabel))))

              (macro relabelfrom ((type ARG1))
                     (call relabelfrom_dirs (ARG1))
                     (call relabelfrom_files (ARG1))
                     (call relabelfrom_lnk_files (ARG1)))

              (macro relabelfrom_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelfrom))))

              (macro relabelfrom_files ((type ARG1))
                     (allow ARG1 fs (files (relabelfrom))))

              (macro relabelfrom_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelfrom))))

              (macro relabelto ((type ARG1))
                     (call relabelto_dirs (ARG1))
                     (call relabelto_files (ARG1))
                     (call relabelto_lnk_files (ARG1)))

              (macro relabelto_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelto))))

              (macro relabelto_files ((type ARG1))
                     (allow ARG1 fs (files (relabelto))))

              (macro relabelto_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelto))))

              (macro rename ((type ARG1))
                     (call rename_dirs (ARG1))
                     (call rename_files (ARG1))
                     (call rename_lnk_files (ARG1)))

              (macro rename_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rename))))

              (macro rename_files ((type ARG1))
                     (allow ARG1 fs (files (rename))))

              (macro rename_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rename))))

              (macro rw ((type ARG1))
                     (call rw_dirs (ARG1))
                     (call rw_files (ARG1))
                     (call rw_lnk_files (ARG1)))

              (macro rw_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rw))))

              (macro rw_files ((type ARG1))
                     (allow ARG1 fs (files (rw))))

              (macro rw_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rw))))

              (macro search ((type ARG1))
                     (allow ARG1 fs search_dir_perms))

              (macro setattr ((type ARG1))
                     (call setattr_dirs (ARG1))
                     (call setattr_files (ARG1))
                     (call setattr_lnk_files (ARG1)))

              (macro setattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (setattr))))

              (macro setattr_files ((type ARG1))
                     (allow ARG1 fs (files (setattr))))

              (macro setattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (setattr))))

              (macro write ((type ARG1))
                     (call write_dirs (ARG1))
                     (call write_files (ARG1))
                     (call write_lnk_files (ARG1)))

              (macro write_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (write))))

              (macro write_files ((type ARG1))
                     (allow ARG1 fs (files (write))))

              (macro write_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (write))))

              ;;
              ;; Policy
              ;;

              (blockinherit fs.obj_template)

              (call sys.mountpoint.obj_type (fs)))

       (block bdev

              ;;
              ;; Contexts
              ;;

              (genfscon "bdev" "/" fs_context)

              ;;
              ;; Macros
              ;;

              (macro add_entries ((type ARG1))
                     (allow ARG1 fs add_entry_dir_perms))

              (macro append_files ((type ARG1))
                     (allow ARG1 fs append_file_perms)
                     (call search (ARG1)))

              (macro create ((type ARG1))
                     (call create_dirs (ARG1))
                     (call create_files (ARG1))
                     (call create_lnk_files (ARG1)))

              (macro create_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (create))))

              (macro create_files ((type ARG1))
                     (allow ARG1 fs (files (create))))

              (macro create_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (create))))

              (macro del_entries ((type ARG1))
                     (allow ARG1 fs del_entry_dir_perms))

              (macro delete ((type ARG1))
                     (call delete_dirs (ARG1))
                     (call delete_files (ARG1))
                     (call delete_lnk_files (ARG1)))

              (macro delete_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (delete))))

              (macro delete_files ((type ARG1))
                     (allow ARG1 fs (files (delete))))

              (macro delete_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (delete))))

              (macro execute ((type ARG1))
                     (allow ARG1 fs exec_file_perms)
                     (call search (ARG1)))

              (macro getattr ((type ARG1))
                     (call getattr_dirs (ARG1))
                     (call getattr_files (ARG1))
                     (call getattr_lnk_files (ARG1)))

              (macro getattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (getattr))))

              (macro getattr_files ((type ARG1))
                     (allow ARG1 fs (files (getattr))))

              (macro getattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (getattr))))

              (macro list ((type ARG1))
                     (allow ARG1 fs list_dir_perms))

              (macro manage ((type ARG1))
                     (call manage_dirs (ARG1))
                     (call manage_files (ARG1))
                     (call manage_lnk_files (ARG1)))

              (macro manage_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (manage))))

              (macro manage_files ((type ARG1))
                     (allow ARG1 fs (files (manage))))

              (macro manage_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (manage))))

              (macro map_files ((type ARG1))
                     (allow ARG1 fs (files (map))))

              (macro mapr_files ((type ARG1))
                     (allow ARG1 fs (files (mapr))))

              (macro maprw_files ((type ARG1))
                     (allow ARG1 fs (files (maprw))))

              (macro maprx ((type ARG1))
                     (allow ARG1 fs (files (maprx))))

              (macro read ((type ARG1))
                     (call list (ARG1))
                     (call read_files (ARG1))
                     (call read_lnk_files (ARG1)))

              (macro read_files ((type ARG1))
                     (allow ARG1 fs (files (read))))

              (macro read_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (read))))

              (macro relabel ((type ARG1))
                     (call relabel_dirs (ARG1))
                     (call relabel_files (ARG1))
                     (call relabel_lnk_files (ARG1)))

              (macro relabel_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabel))))

              (macro relabel_files ((type ARG1))
                     (allow ARG1 fs (files (relabel))))

              (macro relabel_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabel))))

              (macro relabelfrom ((type ARG1))
                     (call relabelfrom_dirs (ARG1))
                     (call relabelfrom_files (ARG1))
                     (call relabelfrom_lnk_files (ARG1)))

              (macro relabelfrom_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelfrom))))

              (macro relabelfrom_files ((type ARG1))
                     (allow ARG1 fs (files (relabelfrom))))

              (macro relabelfrom_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelfrom))))

              (macro relabelto ((type ARG1))
                     (call relabelto_dirs (ARG1))
                     (call relabelto_files (ARG1))
                     (call relabelto_lnk_files (ARG1)))

              (macro relabelto_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (relabelto))))

              (macro relabelto_files ((type ARG1))
                     (allow ARG1 fs (files (relabelto))))

              (macro relabelto_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (relabelto))))

              (macro rename ((type ARG1))
                     (call rename_dirs (ARG1))
                     (call rename_files (ARG1))
                     (call rename_lnk_files (ARG1)))

              (macro rename_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rename))))

              (macro rename_files ((type ARG1))
                     (allow ARG1 fs (files (rename))))

              (macro rename_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rename))))

              (macro rw ((type ARG1))
                     (call rw_dirs (ARG1))
                     (call rw_files (ARG1))
                     (call rw_lnk_files (ARG1)))

              (macro rw_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (rw))))

              (macro rw_files ((type ARG1))
                     (allow ARG1 fs (files (rw))))

              (macro rw_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (rw))))

              (macro search ((type ARG1))
                     (allow ARG1 fs search_dir_perms))

              (macro setattr ((type ARG1))
                     (call setattr_dirs (ARG1))
                     (call setattr_files (ARG1))
                     (call setattr_lnk_files (ARG1)))

              (macro setattr_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (setattr))))

              (macro setattr_files ((type ARG1))
                     (allow ARG1 fs (files (setattr))))

              (macro setattr_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (setattr))))

              (macro write ((type ARG1))
                     (call write_dirs (ARG1))
                     (call write_files (ARG1))
                     (call write_lnk_files (ARG1)))

              (macro write_dirs ((type ARG1))
                     (allow ARG1 fs (dirs (write))))

              (macro write_files ((type ARG1))
                     (allow ARG1 fs (files (write))))

              (macro write_lnk_files ((type ARG1))
                     (allow ARG1 fs (lnk_files (write))))

              ;;
              ;; Policy
              ;;

              (blockinherit fs.obj_template))

    (block binfmt_misc

           ;;
           ;; Contexts
           ;;

           (genfscon "binfmt_misc" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sys.fs_sysctl.search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sys.fs_sysctl.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sys.fs_sysctl.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sys.fs_sysctl.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sys.fs_sysctl.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sys.fs_sysctl.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block cgroup

           ;;
           ;; Contexts
           ;;

           (genfscon "cgroup" "/" fs_context)
           (genfscon "cgroup2" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro mounton_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr mounton))))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sysfs.search (ARG1))
                  (call tmpfs.read_lnk_files (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block cifs

           ;;
           ;; Contexts
           ;;

           (genfscon "cifs" "/" fs_context)
           (genfscon "smbfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create))))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete))))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr))))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage))))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read))))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read))))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read))))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel))))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom))))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto))))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto))))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename))))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename))))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw))))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr))))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr))))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write))))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block configfs

           ;;
           ;; Contexts
           ;;

           (genfscon "configfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sysfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sysfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sysfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sysfs.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sysfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sysfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sysfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block debugfs

           ;;
           ;; Contexts
           ;;

           (genfscon "debugfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sysfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sysfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sysfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sysfs.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sysfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sysfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sysfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block devpts

           ;;
           ;; Contexts
           ;;

           (fsuse trans "devpts" fs_context)

           (genfscon "devpts" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro create_chr_files ((type ARG1))
                  (allow ARG1 self (capability (mknod)))
                  (allow ARG1 fs (chr_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call devtmpfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro manage_chr_files ((type ARG1))
                  (allow ARG1 self (capability (mknod)))
                  (allow ARG1 fs (chr_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro map_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (map))))

           (macro mapr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (mapr)))
                  (call devtmpfs.search (ARG1)))

           (macro maprw_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (maprw)))
                  (call devtmpfs.search (ARG1)))

           (macro obj_type_transition
                  ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                  (typetransition ARG1 fs ARG3 ARG4 ARG2)
                  (call rw_dirs (ARG1)))

           (macro read_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_inherited_chr_files ((type ARG1))
                  (allow ARG1 fs rw_inherited_chr_file_perms))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro setattr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro write_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_inherited_chr_files ((type ARG1))
                  (allow ARG1 fs write_inherited_chr_file_perms))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block devtmpfs

           ;;
           ;; Contexts
           ;;

           (filecon "/dev" dir fs_context)
           (filecon "/dev/.*" any ())

           (fsuse trans "devtmpfs" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (all_files (create))))

           (macro create_blk_files ((type ARG1))
                  (allow ARG1 self (capability (mknod)))
                  (allow ARG1 fs (blk_files (create))))

           (macro create_chr_files ((type ARG1))
                  (allow ARG1 self (capability (mknod)))
                  (allow ARG1 fs (chr_files (create))))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (all_files (delete))))

           (macro delete_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (delete))))

           (macro delete_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (delete))))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (all_files (getattr))))

           (macro getattr_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (getattr))))

           (macro getattr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (getattr))))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (all_files (manage))))

           (macro manage_blk_files ((type ARG1))
                  (allow ARG1 self (capability (mknod)))
                  (allow ARG1 fs (blk_files (manage))))

           (macro manage_chr_files ((type ARG1))
                  (allow ARG1 self (capability (mknod)))
                  (allow ARG1 fs (chr_files (manage))))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage))))

           (macro map_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (map))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (mapr))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (maprw))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro mounton_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr mounton))))

           (macro obj_type_transition
                  ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                  (typetransition ARG1 fs ARG3 ARG4 ARG2)
                  (call rw_dirs (ARG1)))

           (macro read ((type ARG1))
                  (allow ARG1 fs (all_files (read))))

           (macro read_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (read))))

           (macro read_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (read))))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read))))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read))))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (all_files (relabel))))

           (macro relabel_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (relabel))))

           (macro relabel_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabel))))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (all_files (relabelfrom))))

           (macro relabelfrom_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (relabelfrom))))

           (macro relabelfrom_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabelfrom))))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (all_files (relabelto))))

           (macro relabelto_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (relabelto))))

           (macro relabelto_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabelto))))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto))))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (all_files (rename))))

           (macro rename_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (rename))))

           (macro rename_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (rename))))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename))))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (all_files (rw))))

           (macro rw_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (rw))))

           (macro rw_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (rw))))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (all_files (setattr))))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (setattr))))

           (macro setattr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (setattr))))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr))))

           (macro write ((type ARG1))
                  (allow ARG1 fs (all_files (write))))

           (macro write_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (write))))

           (macro write_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (write))))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call tmpfs.associate (fs))
           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs)))

    (block dosfs

           ;;
           ;; Contexts
           ;;

           (filecon "/efi(/.*)?" any fs_context)
           (filecon "/boot/efi(/.*)?" any fs_context)

           (genfscon "fat" "/" fs_context)
           (genfscon "hfs" "/" fs_context)
           (genfscon "hfsplus" "/" fs_context)
           (genfscon "msdos" "/" fs_context)
           (genfscon "ntfs" "/" fs_context)
           (genfscon "ntfs-3g" "/" fs_context)
           (genfscon "vfat" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create))))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete))))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr))))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage))))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read))))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read))))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read))))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel))))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom))))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto))))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto))))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename))))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename))))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw))))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr))))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr))))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write))))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs)))

    (block drm

           ;;
           ;; Contexts
           ;;

           (genfscon "drm" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template))

    (block efivarfs

           ;;
           ;; Contexts
           ;;

           (genfscon "efivarfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sysfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sysfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sysfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sysfs.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sysfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sysfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sysfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block fuse

           ;;
           ;; Contexts
           ;;

           (genfscon "fuse" "/" fs_context)
           (genfscon "fuseblk" "/" fs_context)
           (genfscon "fusectl" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create)))
                  (call sysfs.search (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sysfs.search (ARG1)))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create)))
                  (call sysfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sysfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sysfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sysfs.search (ARG1)))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read)))
                  (call sysfs.search (ARG1)))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read)))
                  (call sysfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write)))
                  (call sysfs.search (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sysfs.search (ARG1)))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write)))
                  (call sysfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block hugetlbfs

           ;;
           ;; Contexts
           ;;

           (fsuse trans "hugetlbfs" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call devtmpfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call devtmpfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call devtmpfs.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call devtmpfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block iso9660

           ;;
           ;; Contexts
           ;;

           (genfscon "iso9660" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create))))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete))))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr))))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage))))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read))))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read))))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read))))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel))))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom))))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto))))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto))))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename))))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename))))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw))))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr))))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr))))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write))))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block nfs

           ;;
           ;; Contexts
           ;;

           (genfscon "afs" "/" fs_context)
           (genfscon "lustre" "/" fs_context)
           (genfscon "nfs" "/" fs_context)
           (genfscon "nfs4" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create))))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete))))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr))))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage))))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read))))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read))))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read))))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel))))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom))))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto))))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto))))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename))))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename))))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw))))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr))))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr))))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write))))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block nfsd

           ;;
           ;; Contexts
           ;;

           (genfscon "nfsd" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block nsfs

           ;;
           ;; Contexts
           ;;

           (genfscon "nsfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template))

    (block proc

           ;;
           ;; Contexts
           ;;

           (filecon "/proc" dir fs_context)
           (filecon "/proc(/.*)?" any ())

           (genfscon "proc" "/" fs_context)
           (genfscon "proc" "/sysvipc" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro mounton_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr mounton))))

           (macro mounton_files ((type ARG1))
                  (allow ARG1 fs (file (getattr mounton))))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs)))

    (block pstore

           ;;
           ;; Contexts
           ;;

           (genfscon "pstore" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create)))
                  (call sysfs.search (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call sysfs.search (ARG1)))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call sysfs.search (ARG1)))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create)))
                  (call sysfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete)))
                  (call sysfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr)))
                  (call sysfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage)))
                  (call sysfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call sysfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call sysfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call sysfs.search (ARG1)))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read)))
                  (call sysfs.search (ARG1)))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call sysfs.search (ARG1)))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read)))
                  (call sysfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom)))
                  (call sysfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto)))
                  (call sysfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename)))
                  (call sysfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw)))
                  (call sysfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call sysfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr)))
                  (call sysfs.search (ARG1)))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write)))
                  (call sysfs.search (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call sysfs.search (ARG1)))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call sysfs.search (ARG1)))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write)))
                  (call sysfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call sys.mountpoint.obj_type (fs)))

    (block removable

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (create))))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (delete))))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (getattr))))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (manage))))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro read ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (read))))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read))))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read))))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabel))))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelfrom))))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (relabelto))))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto))))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rename))))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename))))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (rw))))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (setattr))))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr))))

           (macro write ((type ARG1))
                  (allow ARG1 fs (files_except_blk_and_chr (write))))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template))

    (block rootfs

           ;;
           ;; Contexts
           ;;

           (filecon "/" dir fs_context)

           (filecon "/initrd\.img" symlink fs_context)
           (filecon "/initrd\.img\.old" symlink fs_context)
           (filecon "/vmlinuz" symlink fs_context)
           (filecon "/vmlinuz\.old" symlink fs_context)

           (genfscon "rootfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro audit_write_access_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr write))))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro mounton_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr mounton))))

           (macro obj_type_transition
                  ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                  (typetransition ARG1 fs ARG3 ARG4 ARG2)
                  (call rw_dirs (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs))

           (call obj_type_transition
                 (unconfined_subj_type_attribute fs lnk_file "initrd.img"))
           (call obj_type_transition
                 (unconfined_subj_type_attribute fs lnk_file "initrd.img.old"))
           (call obj_type_transition
                 (unconfined_subj_type_attribute fs lnk_file "vmlinuz"))
           (call obj_type_transition
                 (unconfined_subj_type_attribute fs lnk_file "vmlinuz.old")))

    (block rpc_pipefs

           ;;
           ;; Contexts
           ;;

           (filecon "/run/rpc_pipefs(/.*)?" any ())

           (genfscon "rpc_pipefs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call files.generic_runtime.search (ARG1)))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_fifo_files (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call files.generic_runtime.search (ARG1)))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create)))
                  (call files.generic_runtime.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call files.generic_runtime.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call files.generic_runtime.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call files.generic_runtime.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_fifo_files (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call files.generic_runtime.search (ARG1)))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete)))
                  (call files.generic_runtime.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call files.generic_runtime.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call files.generic_runtime.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_fifo_files (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call files.generic_runtime.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_fifo_files (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call files.generic_runtime.search (ARG1)))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage)))
                  (call files.generic_runtime.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call files.generic_runtime.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call files.generic_runtime.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call files.generic_runtime.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call files.generic_runtime.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_fifo_files (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read)))
                  (call files.generic_runtime.search (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call files.generic_runtime.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_fifo_files (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_fifo_files (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_fifo_files (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call files.generic_runtime.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_fifo_files (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_fifo_files (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call files.generic_runtime.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call files.generic_runtime.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call files.generic_runtime.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_fifo_files (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call files.generic_runtime.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_fifo_files (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call files.generic_runtime.search (ARG1)))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write)))
                  (call files.generic_runtime.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call files.generic_runtime.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call files.generic_runtime.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs)))

    (block sysfs

           ;;
           ;; Contexts
           ;;

           (filecon "/sys" dir fs_context)
           (filecon "/sys(/.*)?" any ())

           (genfscon "sysfs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro dontaudit_audit_access_dirs ((type ARG1))
                  (dontaudit ARG1 fs (dir (audit_access))))

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro audit_write_access_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr write))))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create))))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create))))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create))))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete))))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete))))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete))))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr))))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr))))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr))))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage))))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage))))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro mounton_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr mounton))))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read))))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read))))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel))))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel))))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel))))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom))))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom))))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom))))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto))))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto))))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto))))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename))))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename))))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename))))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw))))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw))))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw))))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr))))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr))))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr))))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write))))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write))))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write))))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs)))

    (block tmpfs

           ;;
           ;; Contexts
           ;;

           (filecon "/tmp" dir fs_context)
           (filecon "/tmp(/.*)?" any ())

           (filecon "/run/user(/.*)?" any ())

           (fsuse trans "mqueue" fs_context)
           (fsuse trans "tmpfs" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro append_blk_files ((type ARG1))
                  (allow ARG1 fs append_blk_file_perms)
                  (call search (ARG1)))

           (macro append_chr_files ((type ARG1))
                  (allow ARG1 fs append_chr_file_perms)
                  (call search (ARG1)))

           (macro append_fifo_files ((type ARG1))
                  (allow ARG1 fs append_fifo_file_perms)
                  (call search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (allow ARG1 fs (all_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro create_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (create)))
                  (call devtmpfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (allow ARG1 fs (all_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro delete_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (delete)))
                  (call devtmpfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (allow ARG1 fs (all_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro getattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (getattr)))
                  (call devtmpfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (allow ARG1 fs (all_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro manage_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (manage)))
                  (call devtmpfs.search (ARG1)))

           (macro map_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (map))))

           (macro mapr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (mapr))))

           (macro maprw_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (maprw))))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr))))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw))))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx))))

           (macro mounton_dirs ((type ARG1))
                  (allow ARG1 fs (dir (getattr mounton))))

           (macro obj_type_transition
                  ((type ARG1)(type ARG2)(class ARG3)(name ARG4))
                  (typetransition ARG1 fs ARG3 ARG4 ARG2)
                  (call rw_dirs (ARG1)))

           (macro read ((type ARG1))
                  (allow ARG1 fs (all_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro read_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (read)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (allow ARG1 fs (all_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabel_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabel)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (allow ARG1 fs (all_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelfrom_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelfrom)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (allow ARG1 fs (all_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro relabelto_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (relabelto)))
                  (call devtmpfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (allow ARG1 fs (all_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rename_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rename)))
                  (call devtmpfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (allow ARG1 fs (all_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_inherited_files ((type ARG1))
                  (allow ARG1 fs rw_inherited_file_perms))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro rw_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (rw)))
                  (call devtmpfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call devtmpfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (allow ARG1 fs (all_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro setattr_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (setattr)))
                  (call devtmpfs.search (ARG1)))

           (macro write ((type ARG1))
                  (allow ARG1 fs (all_files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_blk_files ((type ARG1))
                  (allow ARG1 fs (blk_files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_chr_files ((type ARG1))
                  (allow ARG1 fs (chr_files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_fifo_files ((type ARG1))
                  (allow ARG1 fs (fifo_files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call devtmpfs.search (ARG1)))

           (macro write_sock_files ((type ARG1))
                  (allow ARG1 fs (sock_files (write)))
                  (call devtmpfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template)

           (call xattr.associate (fs))

           (call sys.mountpoint.obj_type (fs)))

    (block tracefs

           ;;
           ;; Contexts
           ;;

           (genfscon "tracefs" "/" fs_context)

           ;;
           ;; Macros
           ;;

           (macro add_entries ((type ARG1))
                  (allow ARG1 fs add_entry_dir_perms)
                  (call debugfs.search (ARG1)))

           (macro append_files ((type ARG1))
                  (allow ARG1 fs append_file_perms)
                  (call search (ARG1)))

           (macro create ((type ARG1))
                  (call create_dirs (ARG1))
                  (call create_files (ARG1))
                  (call create_lnk_files (ARG1)))

           (macro create_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (create)))
                  (call debugfs.search (ARG1)))

           (macro create_files ((type ARG1))
                  (allow ARG1 fs (files (create)))
                  (call debugfs.search (ARG1)))

           (macro create_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (create)))
                  (call debugfs.search (ARG1)))

           (macro del_entries ((type ARG1))
                  (allow ARG1 fs del_entry_dir_perms)
                  (call debugfs.search (ARG1)))

           (macro delete ((type ARG1))
                  (call delete_dirs (ARG1))
                  (call delete_files (ARG1))
                  (call delete_lnk_files (ARG1)))

           (macro delete_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (delete)))
                  (call debugfs.search (ARG1)))

           (macro delete_files ((type ARG1))
                  (allow ARG1 fs (files (delete)))
                  (call debugfs.search (ARG1)))

           (macro delete_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (delete)))
                  (call debugfs.search (ARG1)))

           (macro execute ((type ARG1))
                  (allow ARG1 fs exec_file_perms)
                  (call search (ARG1)))

           (macro getattr ((type ARG1))
                  (call getattr_dirs (ARG1))
                  (call getattr_files (ARG1))
                  (call getattr_lnk_files (ARG1)))

           (macro getattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (getattr)))
                  (call debugfs.search (ARG1)))

           (macro getattr_files ((type ARG1))
                  (allow ARG1 fs (files (getattr)))
                  (call debugfs.search (ARG1)))

           (macro getattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (getattr)))
                  (call debugfs.search (ARG1)))

           (macro list ((type ARG1))
                  (allow ARG1 fs list_dir_perms)
                  (call debugfs.search (ARG1)))

           (macro manage ((type ARG1))
                  (call manage_dirs (ARG1))
                  (call manage_files (ARG1))
                  (call manage_lnk_files (ARG1)))

           (macro manage_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (manage)))
                  (call debugfs.search (ARG1)))

           (macro manage_files ((type ARG1))
                  (allow ARG1 fs (files (manage)))
                  (call debugfs.search (ARG1)))

           (macro manage_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (manage)))
                  (call debugfs.search (ARG1)))

           (macro map_files ((type ARG1))
                  (allow ARG1 fs (files (map))))

           (macro mapr_files ((type ARG1))
                  (allow ARG1 fs (files (mapr)))
                  (call debugfs.search (ARG1)))

           (macro maprw_files ((type ARG1))
                  (allow ARG1 fs (files (maprw)))
                  (call debugfs.search (ARG1)))

           (macro maprx ((type ARG1))
                  (allow ARG1 fs (files (maprx)))
                  (call debugfs.search (ARG1)))

           (macro read ((type ARG1))
                  (call list (ARG1))
                  (call read_files (ARG1))
                  (call read_lnk_files (ARG1)))

           (macro read_files ((type ARG1))
                  (allow ARG1 fs (files (read)))
                  (call debugfs.search (ARG1)))

           (macro read_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (read)))
                  (call debugfs.search (ARG1)))

           (macro relabel ((type ARG1))
                  (call relabel_dirs (ARG1))
                  (call relabel_files (ARG1))
                  (call relabel_lnk_files (ARG1)))

           (macro relabel_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabel)))
                  (call debugfs.search (ARG1)))

           (macro relabel_files ((type ARG1))
                  (allow ARG1 fs (files (relabel)))
                  (call debugfs.search (ARG1)))

           (macro relabel_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabel)))
                  (call debugfs.search (ARG1)))

           (macro relabelfrom ((type ARG1))
                  (call relabelfrom_dirs (ARG1))
                  (call relabelfrom_files (ARG1))
                  (call relabelfrom_lnk_files (ARG1)))

           (macro relabelfrom_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelfrom)))
                  (call debugfs.search (ARG1)))

           (macro relabelfrom_files ((type ARG1))
                  (allow ARG1 fs (files (relabelfrom)))
                  (call debugfs.search (ARG1)))

           (macro relabelfrom_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelfrom)))
                  (call debugfs.search (ARG1)))

           (macro relabelto ((type ARG1))
                  (call relabelto_dirs (ARG1))
                  (call relabelto_files (ARG1))
                  (call relabelto_lnk_files (ARG1)))

           (macro relabelto_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (relabelto)))
                  (call debugfs.search (ARG1)))

           (macro relabelto_files ((type ARG1))
                  (allow ARG1 fs (files (relabelto)))
                  (call debugfs.search (ARG1)))

           (macro relabelto_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (relabelto)))
                  (call debugfs.search (ARG1)))

           (macro rename ((type ARG1))
                  (call rename_dirs (ARG1))
                  (call rename_files (ARG1))
                  (call rename_lnk_files (ARG1)))

           (macro rename_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rename)))
                  (call debugfs.search (ARG1)))

           (macro rename_files ((type ARG1))
                  (allow ARG1 fs (files (rename)))
                  (call debugfs.search (ARG1)))

           (macro rename_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rename)))
                  (call debugfs.search (ARG1)))

           (macro rw ((type ARG1))
                  (call rw_dirs (ARG1))
                  (call rw_files (ARG1))
                  (call rw_lnk_files (ARG1)))

           (macro rw_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (rw)))
                  (call debugfs.search (ARG1)))

           (macro rw_files ((type ARG1))
                  (allow ARG1 fs (files (rw)))
                  (call debugfs.search (ARG1)))

           (macro rw_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (rw)))
                  (call debugfs.search (ARG1)))

           (macro search ((type ARG1))
                  (allow ARG1 fs search_dir_perms)
                  (call debugfs.search (ARG1)))

           (macro setattr ((type ARG1))
                  (call setattr_dirs (ARG1))
                  (call setattr_files (ARG1))
                  (call setattr_lnk_files (ARG1)))

           (macro setattr_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (setattr)))
                  (call debugfs.search (ARG1)))

           (macro setattr_files ((type ARG1))
                  (allow ARG1 fs (files (setattr)))
                  (call debugfs.search (ARG1)))

           (macro setattr_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (setattr)))
                  (call debugfs.search (ARG1)))

           (macro write ((type ARG1))
                  (call write_dirs (ARG1))
                  (call write_files (ARG1))
                  (call write_lnk_files (ARG1)))

           (macro write_dirs ((type ARG1))
                  (allow ARG1 fs (dirs (write)))
                  (call debugfs.search (ARG1)))

           (macro write_files ((type ARG1))
                  (allow ARG1 fs (files (write)))
                  (call debugfs.search (ARG1)))

           (macro write_lnk_files ((type ARG1))
                  (allow ARG1 fs (lnk_files (write)))
                  (call debugfs.search (ARG1)))

           ;;
           ;; Policy
           ;;

           (blockinherit fs.obj_template))

    (block xattr

           ;;
           ;; Contexts
           ;;

           (fsuse task "pipefs" isid_context)
           (fsuse task "sockfs" isid_context)

           (fsuse xattr "btrfs" isid_context)
           (fsuse xattr "encfs" isid_context)
           (fsuse xattr "ext2" isid_context)
           (fsuse xattr "ext3" isid_context)
           (fsuse xattr "ext4" isid_context)
           (fsuse xattr "fuse.glusterfs" isid_context)
           (fsuse xattr "gfs" isid_context)
           (fsuse xattr "gfs2" isid_context)
           (fsuse xattr "gpfs" isid_context)
           (fsuse xattr "hdfs" isid_context)
           (fsuse xattr "jffs2" isid_context)
           (fsuse xattr "jfs" isid_context)
           (fsuse xattr "lustre" isid_context)
           (fsuse xattr "ocfs2" isid_context)
           (fsuse xattr "overlay" isid_context)
           (fsuse xattr "shiftfs" isid_context)
           (fsuse xattr "squashfs" isid_context)
           (fsuse xattr "xfs" isid_context)
           (fsuse xattr "zfs" isid_context)

           (sidcontext fs isid_context)

           ;;
           ;; Macros
           ;;

           (macro associate ((type ARG1))
                  (allow ARG1 isid (filesystem (associate))))

           (macro getattr_fs ((type ARG1))
                  (allow ARG1 isid (filesystem (getattr))))

           (macro mount ((type ARG1))
                  (allow ARG1 isid (filesystem (mount))))

           (macro quotaget ((type ARG1))
                  (allow ARG1 isid (filesystem (quotaget))))

           (macro quotamod ((type ARG1))
                  (allow ARG1 isid (filesystem (quotamod))))

           (macro relabel_fs ((type ARG1))
                  (allow ARG1 isid (filesystem (getattr relabelfrom
                                                        relabelto))))

           (macro relabelfrom_fs ((type ARG1))
                  (allow ARG1 isid (filesystem (getattr relabelfrom))))

           (macro relabelto_fs ((type ARG1))
                  (allow ARG1 isid (filesystem (getattr relabelto))))

           (macro remount ((type ARG1))
                  (allow ARG1 isid (filesystem (remount))))

           (macro unmount ((type ARG1))
                  (allow ARG1 isid (filesystem (unmount))))

           ;;
           ;; Policy
           ;;

           (blockinherit sys.isid.stub)

           (call fs.obj_type (isid))))
